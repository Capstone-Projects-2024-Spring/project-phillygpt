---
sidebar_position: 5
---
# Backend Class Diagram


![Backend Diagram](https://www.mermaidchart.com/raw/7eb95f12-1886-496e-9d4f-ffad9fbf2619?theme=light&version=v0.1&format=svg)

## Classes and Descriptions

### `FlaskApp`
- **Attributes**: `tunnel`, `connection`
- **Operations**: `initialize_connection()`, `close_connection(exception)`, `get_example1()`, `get_example2()`, `get_example3()`, `get_example4()`
- **Description**: This class defines the main Flask application, handling initialization of SSH tunnel and database connections, closing connections, and managing API routes.

### `DatabaseConnection`
- **Operations**: `execute_function_cursor(func, args, kwargs)`, `get_database_uri()`, `get_schema_representation(cursor)`, `getField(fieldname, table_name)`, `execute_get_field(cursor, fieldname, table_name)`
- **Description**: Manages database connections and SSH tunnels, provides utility methods for executing database operations with cursor support, and handles schema and field data retrieval.

### `SQLQueryExecution`
- **Operations**: `execute_sql_query(sql_query)`
- **Description**: Encapsulates the functionality to execute SQL queries through an established SSH tunnel connection, ensuring secure database interactions.

### `ProcessInput`
- **Operations**: `post()`, `openai_request(user_input)`, `determine_proper_table(user_input)`
- **Description**: This class is responsible for handling user inputs, generating SQL queries via OpenAI based on user prompts, and determining the appropriate database tables for queries.

### `ProcessInputMap`
- **Operations**: `post()`, `openai_request(user_input, marker_text)`
- **Description**: Similar to `ProcessInput`, this class handles POST requests and uses OpenAI to generate SQL queries but focuses on map-related inputs and interactions.

### `Reprompt`
- **Operations**: `post()`, `generate_reprompt_suggestions(user_input, table_name)`, `openai_reprompt_req(suggestion)`, `refine_prompts(prompts)`
- **Description**: Handles re-prompting logic when initial user inputs do not clearly correspond to database schema, using OpenAI to refine prompts and suggestions for better user interaction.

### `Sandbox`
- **Operations**: `geocode_address(address)`, `main()`
- **Description**: Provides utility functions like geocoding addresses and a main function for processing geocoding and database updates based on geocoded results.

### `ValidateSQLQuery`
- **Operations**: `validate_sql_query(sql_query)`
- **Description**: Ensures that SQL queries generated by the system or received from user inputs are safe and free from SQL injection vulnerabilities through pattern matching and validation logic.


